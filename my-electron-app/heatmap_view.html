<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- D3JS -->
    <script src="https://d3js.org/d3.v4.js"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />

    <title>Protein Visualization Dashboard</title>
  </head>

  <body class="m-2">
    <div class="d-flex justify-content-between">
      <div>
        <h2>Protein Modfication Tab</h2>
      </div>
      <div>
        <div class="card" style="width: 26rem;">
          <div class="card-body">
            <h5 class="card-title">Current State</h5>
            <p class="card-text" style="display:inline">Selcted protein: <p id="state_selected_protein" style="display:inline"/></p>
            <br/>
            <p class="card-text" style="display:inline">Selcted samples: <p id="state_selected_samples" style="display:inline"/></p>
            <br/>
            <p class="card-text" style="display:inline">Selcted normalization: <p id="state_selected_normalization" style="display:inline"/></p>
            <br/>
            <p class="card-text" style="display:inline">Min modification count: <p id="state_selected_min_count" style="display:inline"/></p>
          </div>
        </div>
      </div>
    </div>        
    <table cellspacing="0" cellpadding="0" class="m-2">
        <tr>
          <td id="mod_heatmap">
            <h5>Distribution of modifications</h5> 
            <p>Normalized by
              <select aria-label="Select normalization value" id="normalization_select"">
                <option value="">No normalization</option>
                <option value="protein_intensity">Intensity</option>
                <option value="protein_total_mod_count">
                  Total modification count
                </option>
              </select>
              with total count above 
              <input type="number" id="min_mod_count_input" min="0" max="30000"/>
            </b><a class="ml-2 btn btn-sm btn-secondary" value="Submit" onclick="onNormalizationFormSubmit();">Submit</a></p>
          </td>
          <td id="graphDiv2">
          <div id="no_protein_div_2"></div>
                    
          <h5> Distribution of modifications for each sample.</h5></br><br>
          </td>
        </tr>
    </table>    
    <!-- Scripts -->
    <script>
    // init global state
      minModificationCount = 0;
      normalizationType = "";
    </script>
    <script type="text/javascript">
    // init global state
      minModificationCount = 0;
      normalizationType = "";
      selectedProtein = "";
      selectedSample = [];
      // init global state
      document.getElementById("min_mod_count_input").value =
        minModificationCount;
      document.getElementById("normalization_select").value = normalizationType;
      document.getElementById("state_selected_protein").value = selectedProtein;
      document.getElementById("state_selected_samples").value = selectedSample;
    </script>
    <script
      type="text/javascript"
      src="./static/mod_sample_heatmap.js"
    ></script>
    <script
      type="text/javascript"
      src="./static/protein_mod_heatmap.js"
    ></script>
    <script>
      function onNormalizationFormSubmit() {
        minModificationCount = document.getElementById(
          "min_mod_count_input"
        ).value;
        normalizationType = document.getElementById(
          "normalization_select"
        ).value;
        document.getElementById("state_selected_normalization").textContent = normalizationType;
        document.getElementById("state_selected_min_count").textContent = minModificationCount;
        renderProteinModPlot();
        //renderSampleModPlot();
      }
    </script>
  </body>
</html>
